<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[日々、しこうさくごの足あと]]></title>
  <link href="http://kixonn.github.io/atom.xml" rel="self"/>
  <link href="http://kixonn.github.io/"/>
  <updated>2014-12-24T10:57:29+09:00</updated>
  <id>http://kixonn.github.io/</id>
  <author>
    <name><![CDATA[kixonn]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Gentoo における Rust 環境]]></title>
    <link href="http://kixonn.github.io/blog/2014/12/22/dev-rust-in-gentoo/"/>
    <updated>2014-12-22T08:00:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2014/12/22/dev-rust-in-gentoo</id>
    <content type="html"><![CDATA[<p>
この記事は <a href="http://qiita.com/advent-calendar/2014/gentoo">Gentoo Advent Calendar 2014 - Qiita</a> の 22 日目の記事です。
投稿が遅れましたが、 emerge アップデートかけてたら遅くなったということでお許しください。
</p>




<p>
21 日目は @mazgi さんで、 <a href="http://blog.mazgi.net/entry/increase-ulimit-on-gentoo">How to increase ulimit on #Gentoo ?</a> というタイトルで Gentoo の LSB スクリプトにおける fd の調整について解説いただきました。
</p>




<p>
さて、最近 Hacker news を見ていると注目度合いがここにきて上昇している rust ですが、当然 Gentoo でもインストールできます。
</p>




<p>
すでに、公式の portage にも入っているとおり下記の ebuild が存在します。
</p>




<ul class="org-ul">
<li>app-emacs/rust-mode
</li>
<li>app-shells/rust-zshcomp
</li>
<li>app-admin/eselect-rust
</li>
<li>dev-lang/rust
</li>
</ul>




<p>
これで、お分かりになられた方もおられると思いますが、 eselect module があり、当然 eselect で rust のバージョンを切り換えることができます。
現在は 0.11, 0.12, nightly, git の 4 つのバージョンが用意されています。
</p>




<p>
一方で rust のパッケージマネージャである cargo は ebuild が用意されていません。
調べたところ rust という名前の overlay があり cargo の ebuild を扱っているのですが、対応する rust のバージョンが rust:git 対応するものだけでした。 <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>
</p>




<p>
私は rust:nightly を使用しているのですが、 cargo の最新版は rust の nightly ではビルドできないようでした。
そこで nightly 用の cargo を書きました。 github のリンクを貼っておきます。
</p>




<p>
<a href="https://github.com/kixonn/portage/blob/master/dev-rust/cargo/cargo-999-r1.ebuild">https://github.com/kixonn/portage/blob/master/dev-rust/cargo/cargo-999-r1.ebuild</a>
</p>




<p>
ただし、ただ rust をインストールしただけの状態ですと、 <code>rustc</code> が存在しませんので、 <code>eselect rust set 1</code> を実行して symlink を作成しておく必要があります。
</p>




<p>
将来的には python の pip のように、 eselect python set 1 とすると cargo のバージョンも柔軟に切り替えられるようにすることで、 Gentoo の強みを生かせるようにしていきたいですね。
</p>




<p>
22 日目はこれで終わりですが、明日以降のカレンダーは入っていないのですが、どうなるんでしょう (^^;;
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">参照</h2>
<div class="outline-text-2" id="text-1">
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
&#8220;Gentoo Portage Overlays - Browse Portage&#8221; <a href="http://gpo.zugaina.org/Overlays/rust">http://gpo.zugaina.org/Overlays/rust</a>
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[mpd で pulseaudio を出力先に指定する]]></title>
    <link href="http://kixonn.github.io/blog/2014/11/02/mpd-conf-for-pulseaudio/"/>
    <updated>2014-11-02T00:00:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2014/11/02/mpd-conf-for-pulseaudio</id>
    <content type="html"><![CDATA[<p>
ALSA をオーディオの出力先に使用しているアプリケーションが mpd の他にあり、そちらを pulseaudio 対応するのが面倒だったので、多少音質が悪くなってもいいという妥協点で、 mpd のオーディオ出力先を pulseaudio にしようとしたら、少し嵌ったのでメモ。
</p>




<p>
単純に <code>mpd.conf</code> の出力先に pulseaudio を以下のように追記して、 =mpc enable &#8220;My Pulse Output&#8221; とやるだけではダメで。
どうやら、 pulseaudio に出力できないと mpd から怒られる。
</p>




<p>
悪いのは pulseaudio の設定で、 <code>/etc/pulse/default.pa</code> を書き換える必要がある。
</p>




<pre class="example">
-#load-module module-native-protocol-tcp
+load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1
</pre>




<p>
書き換えた後に pulseaudio を再起動。
</p>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>pulseaudio --kill
</span><span class='line'><span class="nv">$ </span>pulseaudio --start --log-target<span class="o">=</span>syslog
</span></code></pre></td></tr></table></div></figure>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">参照</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://wiki.archlinux.org/index.php/MPD/Tips_and_Tricks#PulseAudio">https://wiki.archlinux.org/index.php/MPD/Tips_and_Tricks#PulseAudio</a> &#8220;Music Player Daemon/Tips and tricks - ArchWiki&#8221;
</p>
</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[シェルスクリプト中で ip アドレスをゲットする方法]]></title>
    <link href="http://kixonn.github.io/blog/2014/09/18/get-ipv4-addr-in-shell/"/>
    <updated>2014-09-18T00:34:55+09:00</updated>
    <id>http://kixonn.github.io/blog/2014/09/18/get-ipv4-addr-in-shell</id>
    <content type="html"><![CDATA[<p>
シェルスクリプトで IP アドレスだけ取得したい場合、どのようにすれば取得できるか調べていると、下記のような方法があった <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 。
</p>


<figure class='code'><figcaption><span> (get_ipv4_01.sh)</span> <a href='http://kixonn.github.io/downloads/code/20140917/get_ipv4_01.sh'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ip addr | grep <span class="s1">&#39;state UP&#39;</span> -A2 | tail -n1 | awk <span class="s1">&#39;{print $2}&#39;</span> | cut -f1 -d<span class="s1">&#39;/&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<p>
下記のような方法も考えたけど、イマイチなので↑のほうがいいのかなぁ。
</p>




<figure class='code'><figcaption><span> (get_ipv4_02.sh)</span> <a href='http://kixonn.github.io/downloads/code/20140917/get_ipv4_02.sh'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ip -f inet addr show | grep <span class="s1">&#39;state UP&#39;</span> -A1 | grep -o -e <span class="s1">&#39;[0-9]\+\.[0-9]\+\.[0-9]\+\.[0-9]\+/[0-9]\+&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<p>
ちなみに、 AWS EC2 上だと、 api 経由で以下のように取れるので、 AWS 上では綺麗に書ける。
</p>




<figure class='code'><figcaption><span> (get_ipv4_03.sh)</span> <a href='http://kixonn.github.io/downloads/code/20140917/get_ipv4_03.sh'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>curl http://169.254.169.254/latest/meta-data/local-ipv4
</span></code></pre></td></tr></table></div></figure>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://unix.stackexchange.com/questions/119269/how-to-get-ip-address-using-shell-script">http://unix.stackexchange.com/questions/119269/how-to-get-ip-address-using-shell-script</a> bash - How to get IP Address using shell script? - Unix &amp; Linux Stack Exchange
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[cdrdao で AccurateRip]]></title>
    <link href="http://kixonn.github.io/blog/2014/09/09/ripping-cd-by-cdrdao/"/>
    <updated>2014-09-09T12:07:25+09:00</updated>
    <id>http://kixonn.github.io/blog/2014/09/09/ripping-cd-by-cdrdao</id>
    <content type="html"><![CDATA[<p>
cd をリッピングする際は今まで、 EAC (Exact Audio Copy) <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> を使って windows 上で、 cd をリッピングしてた。
cddb に gracenote 使ってタグ付けしたかったからなのだけど、 api 叩けば linux からでも十分に使用できたのでわざわざ windows を立ち上げて EAC を使う必要性も感じなくなった。
</p>




<p>
それで、 AccurateRip に対応したリッピングソフトを調べていたのだけど、最初は AccurateRip 準拠な cdparanoia を使用したいと考えたものの、設定項目が多く学習コストが高いため、 cdparanoia をラップするアプリケーションを利用してみることにした。調べてみると、二つの候補として以下のものがあった。
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">abcde</h2>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">cdrdao</h2>
<div class="outline-text-2" id="text-2">
<p>
abcde を初めに使ってみたが、いざリッピングすると mkcue がないと怒られた。調べてみると mkcue 自体は完全に他から取ってこないといけないようで面倒。また、 abcde 自体も思った通りの動作をしてくれず、使いづらいように感じた。
</p>

<p>
cdrdao については、 man も読みやすく内部で何を行っているのか明快であったため、使いやすく感じた。
例えば、 cdrdao を使ってリッピングを行う場合は以下のように行うだけだった <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup> 。
</p>

<figure class='code'><figcaption><span> (cdrdao_rip.sh)</span> <a href='http://kixonn.github.io/downloads/code/20140909/cdrdao_rip.sh'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>cdrdao <span class="nb">read</span>-cd --device /dev/sr0 --read-raw --paranoia-mode 3 --datafile file.bin file.toc
</span></code></pre></td></tr></table></div></figure>

<p>
あと、 flac + cue な形式に変換するには以下のようにするだけ。
</p>

<figure class='code'><figcaption><span> (conv_flac.sh)</span> <a href='http://kixonn.github.io/downloads/code/20140909/conv_flac.sh'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>flac -6 -V --force-raw --sample-rate<span class="o">=</span>44100 --channels<span class="o">=</span>2 --bps<span class="o">=</span>16 --endian<span class="o">=</span>big --sign<span class="o">=</span>signed file.bin -o file.flac
</span><span class='line'>toc2cue file.toc file.cue
</span></code></pre></td></tr></table></div></figure>

<p>
便利でしょ!!
</p>
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://www.exactaudiocopy.de/">http://www.exactaudiocopy.de/</a> Exact Audio Copy
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="http://www.hydrogenaud.io/forums/index.php?showtopic=88238">http://www.hydrogenaud.io/forums/index.php?showtopic=88238</a> Perfect Single-File FLAC: cdrdao vs. abcde - Hydrogenaudio Forums
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[unzip_in_gentoo]]></title>
    <link href="http://kixonn.github.io/blog/2014/06/22/unzip-in-gentoo/"/>
    <updated>2014-06-22T10:47:08+09:00</updated>
    <id>http://kixonn.github.io/blog/2014/06/22/unzip-in-gentoo</id>
    <content type="html"><![CDATA[<p>
Gentoo で zip ファイル展開時に文字化け (zip ファイルの中のファイル名が、 shift-jis でエンコードされている) することがある。以下のようにすればよいらしい <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 。
</p>




<pre class="example">
% sudo USE="nastspec" emerge -uDt unzip
</pre>




<p>
下手に mvconv とかしなくてもよかったみたいです。←したひと
</p>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://insnvlovn.blogspot.jp/2011/06/unzip.html">http://insnvlovn.blogspot.jp/2011/06/unzip.html</a> 日記 (gentoo,php): unzip の文字化け
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux から Android OS を起動して Kindle を読む]]></title>
    <link href="http://kixonn.github.io/blog/2014/04/27/genymotion-on-linux/"/>
    <updated>2014-04-27T00:00:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2014/04/27/genymotion-on-linux</id>
    <content type="html"><![CDATA[<p>
Linux で Android を動かしたいというか Kindle を動かして本を読みたかったので、 Genymotion のインストールを試みてみた。 すでに Virtual Box はインストールしているので、そのままイメージをインストールして動かしてもよかったのだけど、パフォーマンスを発揮させたいので、 AndroVM の後継である Genymotion を動かしたログ。 Windows 上で動かした報告はたくさんあるけど、 Linux はなかなかなかったので残してみた。
</p>




<p>
amd64 環境なので、 Debian 向けの実行ファイルをダウンロードする。このあとの準備として、必要なライブラリとして <code>libaudio.so</code> を含んでいる <code>media-libs/nas</code> と <code>dev-util/android-sdk-update-manager</code> を <code>emerge</code> しておく。あと、もちろん、だけど <code>adb</code> のインストールもしておく。
</p>




<pre class="example">
{ % img [] downloads/image/20140427/2014-04-27-scrot1.png [640] %}
</pre>




<p>
ダウンロードしたファイルを実行すると同じ階層に genymotion フォルダが作成されて、色々なファイルがダウンロードされるので、その中の genymotion を実行する。あとは、 Windows 版とかと同じ。今回は、 Nexus 7 のイメージを選んでみた。なお、 Android のバージョンは 4.3 を選択しないと Kindle が動かないので、 4.3 を選択したほうがよい。 Play ボタンを押すとデフォルトの設定のまま動いた。あとは、 Play アプリをインストールするためにリンク先 <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> に従う。
</p>




<p>
Google Play 経由で Kindle をインストールすると解像度にもよるけどいい感じに表示されたので、これからはこれで Kindle 本を読んでもいいかもしれない (キャンペーンやってて、 Kindle 買ったけど) 。
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">参照</h2>
<div class="outline-text-2" id="text-1">
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
[GUIDE] Genymotion | Installing ARM Translation and GApps[Updated Nov.16] - xda-developers - <a href="http://forum.xda-developers.com/showthread.php?t=2528952">http://forum.xda-developers.com/showthread.php?t=2528952</a>
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ディレクトリ配下のファイルの文字コードを変更する]]></title>
    <link href="http://kixonn.github.io/blog/2013/12/01/modify-char-encording-under-dir/"/>
    <updated>2013-12-01T10:33:16+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/12/01/modify-char-encording-under-dir</id>
    <content type="html"><![CDATA[<p>
ディレクトリ配下の特定ファイルの文字エンコードを変更したい場合があったため、メモ。今回の場合だと cue ファイルのエンコードを変更したかったので、 cue ファイルを指定して探索。
</p>




<pre class="example">
<figure class='code'><figcaption><span> (encode_cue_to_utf8.sh)</span> <a href='http://kixonn.github.io/downloads/code/20131201/encode_cue_to_utf8.sh'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="k">for </span>file in <span class="sb">`</span>find . -type f -name <span class="s1">&#39;*.cue&#39;</span><span class="sb">`</span>;
</span><span class='line'><span class="k">do</span>
</span><span class='line'><span class="k">    </span>nkf -w --in-place file
</span><span class='line'><span class="k">done</span>
</span><span class='line'>
</span><span class='line'><span class="nb">exit</span>
</span></code></pre></td></tr></table></div></figure>
</pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[User Agent Switcher を Vimperator からいただく]]></title>
    <link href="http://kixonn.github.io/blog/2013/12/01/user-agent-switch-by-vimperator/"/>
    <updated>2013-12-01T01:35:53+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/12/01/user-agent-switch-by-vimperator</id>
    <content type="html"><![CDATA[<p>
User Agent Switcher を vimperator から操作したいので、調べてみた。すでにやっておられた方がいらした <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 。
</p>




<p>
リンク先のコードは期限切れだったが、 vimperator-plugins のリポジトリ <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup> にあったため、利用。
</p>




<p>
使い方はリンク先と同様に、以下の通り。
</p>




<pre class="example">
:ua [切り替えるエージェント名]
</pre>


<p>
でエージェントを切り替え。
</p>




<pre class="example">
:ua Default
</pre>


<p>
でデフォルトに。
</p>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://mattn.kaoriya.net/software/firefox/vimperator/20080724195945.htm">http://mattn.kaoriya.net/software/firefox/vimperator/20080724195945.htm</a> Big Sky :: UserAgent を切り替えられる vimperator plugin 、「 uaSwitch.js 」書いた。
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="https://github.com/vimpr/vimperator-plugins">https://github.com/vimpr/vimperator-plugins</a> vimpr/vimperator-plugins · GitHub
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Portage で configure 時に任意のオプションを付加する]]></title>
    <link href="http://kixonn.github.io/blog/2013/10/22/extra-conf-in-portage/"/>
    <updated>2013-10-22T10:24:35+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/10/22/extra-conf-in-portage</id>
    <content type="html"><![CDATA[<p>
portage をパッケージ管理ツールに使用していると、「あれ、このコンパイル時にオプション有効になってないの？」と思ったりすることがある。 ebuild を確認して、 USE フラグと照らし合わせてオプションが定義されていなかったりする場合がごくまれにある。そういったときは、オレオレ ebuild を作成するのがいいんだけど、一時的に試してみるなら以下のように指定することもできる <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 。
</p>




<pre class="example">
EXTRA_ECONF="--enable-foo ......" emerge package
</pre>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://rony.wikidot.com/gentoo:portage-extra-econf">http://rony.wikidot.com/gentoo:portage-extra-econf</a> Gentoo Portage: emerge with EXTRA<sub>ECONF</sub> - Rony
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[xmonad でボーダを消す]]></title>
    <link href="http://kixonn.github.io/blog/2013/08/16/xmonad-contrib-smartborder/"/>
    <updated>2013-08-16T08:18:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/08/16/xmonad-contrib-smartborder</id>
    <content type="html"><![CDATA[<p>
普段はウィンドウマネージャとして xmonad を使っているけど、ウィンドウをワークスペースに対してフルスクリーン表示したときにフォーカスを示すためのボーダが表示されるのに困っていた。
例えば、 ウィンドウの大きさが BoderWidth x 2 px 分削られるので VMware とか使うときに困る。
</p>




<p>
解決としては xmonad-contrib にある XMonad.Layout.NoBorders を import して smartBorders を使って以下のように layoutHook に書けばよい <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 。
</p>




<figure class='code'><figcaption><span>&#8220;xmonad.hs&#8221;  (xmonad.hs)</span> <a href='http://kixonn.github.io/downloads/code/20130816/xmonad.hs'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">main</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
</span><span class='line'>    <span class="n">xmonad</span> <span class="o">$</span> <span class="n">defaultConfig</span>
</span><span class='line'>        <span class="n">layoutHook</span> <span class="ow">=</span> <span class="n">smartBorders</span> <span class="o">$</span> <span class="n">mkToggle1</span> <span class="kt">FULL</span> <span class="o">$</span> <span class="n">desktopLayoutModifiers</span> <span class="p">(</span><span class="n">named</span> <span class="s">&quot;V&quot;</span> <span class="n">tall</span> <span class="o">|||</span> <span class="p">(</span><span class="n">named</span> <span class="s">&quot;H&quot;</span> <span class="o">$</span> <span class="kt">Mirror</span> <span class="n">tall</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>




<p>
smartBorders を使うと，ワークスペースにウィンドウが一つしかないときには、ボーダを表示してくれなくなる。
これで、合理的なインターフェイスになるし、スッキリした。
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">参照</h2>
<div class="outline-text-2" id="text-1">
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
haskell - How to delete borders in &#8220;Full&#8221; layout from xmonad default config? - Stack Overflow <a href="http://stackoverflow.com/questions/10642644/how-to-delete-borders-in-full-layout-from-xmonad-default-config">http://stackoverflow.com/questions/10642644/how-to-delete-borders-in-full-layout-from-xmonad-default-config</a>
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Locomotive CMS を Apache 上で動かす]]></title>
    <link href="http://kixonn.github.io/blog/2013/08/08/locomotive-cms-in-apache/"/>
    <updated>2013-08-08T06:25:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/08/08/locomotive-cms-in-apache</id>
    <content type="html"><![CDATA[<p>
ruby で作成された CMS を使ってサイトを構築したいと考えていたところ、 Locomotive CMS <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> というのを見つけたので触ってみる。
バックエンドの DB として MongoDB を使っていのも面白そうだった。
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">導入</h2>
<div class="outline-text-2" id="text-1">
<p>
CentOS での導入手順としては、日本語で解説されている記事 <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup> があったり、公式ページの Guide に載っていたりするので、そちらを参考にコマンドをまとめてみる。なお，事前に rvm や passenger や MongoDB のインストールは任意の方法で行っておく。
</p>

<pre class="example">
$ mkdir -p ~/rails
$ cd rails
$ gem install rails --version=3.2.14
$ rails new locomotive --skip-active-record --skip-test-unit --skip-javascript --skip-bundle
$ echo "gem 'rails', '3.2.14'
gem 'locomotive_cms', '~&gt; 2.0.1', require: 'locomotive/engine'
gem 'therubyracer', '&gt;= 0.8.2' # Linux only

gem 'unicorn', group: :development
gem 'thin', group: :production

group :assets do
  gem 'compass-rails',  '~&gt; 1.0.2'
  gem 'sass-rails',     '~&gt; 3.2.4'
  gem 'coffee-rails',   '~&gt; 3.2.2'
  gem 'uglifier',       '~&gt; 1.2.4'
end" &gt; Gemfile
$ bundle install
$ bundle exec rails generate locomotive:install
</pre>

<p>
Passenger 周りの設定について以下のように書く。
</p>

<figure class='code'><figcaption><span>&#8220;/etc/httpd/modules/mod_passenger.conf&#8221;  (passenger.conf)</span> <a href='http://kixonn.github.io/downloads/code/20130808/passenger.conf'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># passenger-install-apache2-module --snippet を実行して表示される設定を使用。</span>
</span><span class='line'>LoadModule passenger_module /usr/lib64/httpd/modules/mod_passenger.so
</span><span class='line'>PassengerRoot /usr/local/rvm/gems/ruby-1.9.3-p448/gems/passenger-4.0.10
</span><span class='line'>PassengerDefaultRuby /usr/local/rvm/wrappers/ruby-1.9.3-p448/ruby
</span><span class='line'>PassengerResolveSymlinksInDocumentRoot on
</span><span class='line'>
</span><span class='line'>&lt;VirtualHost *:80&gt;
</span><span class='line'>  DocumentRoot <span class="s2">&quot;/home/www/&quot;</span>
</span><span class='line'>  RackBaseURI /locomotive
</span><span class='line'>  <span class="c"># RailsEnv production</span>
</span><span class='line'>  RailsEnv development
</span><span class='line'>  <span class="c"># 今回は development モードで動かしてみる</span>
</span><span class='line'>  PassengerEnabled on
</span><span class='line'>
</span><span class='line'>  &lt;Directory /home/www/locomotive &gt;
</span><span class='line'>  <span class="c"># Options ExecCGI FollowSymLinks</span>
</span><span class='line'>    Options -MultiViews -Indexes
</span><span class='line'>    AllowOverride All
</span><span class='line'>    Order Allow,Deny
</span><span class='line'>    Allow from all
</span><span class='line'>  &lt;/Directory&gt;
</span><span class='line'>  <span class="c"># PassengerMaxPoolSize 30</span>
</span><span class='line'>  <span class="c"># PassengerMaxInstancesPerApp 1</span>
</span><span class='line'>&lt;/VirtualHost&gt;
</span></code></pre></td></tr></table></div></figure>

<p>
なお、今回は Document Root に設置していないので (?) 、 Save 機能がうまく機能しなかった。 Document Root に設定しないとうまく動かないっぽいので、運用の際には注意が必要。癖がありすぎる、レスポンスが遅い ( MongoDB が原因?) ので、運用していく予定はない。けど、グラフィカルで気持ちがよいので、今後が気になるところ。
</p>
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://www.locomotivecms.com/">http://www.locomotivecms.com/</a> LocomotiveCMS is an open source CMS for Rails
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="http://xxxcaqui.hatenablog.cofffffffffffm/entry/2013/04/12/210928">http://xxxcaqui.hatenablog.cofffffffffffm/entry/2013/04/12/210928</a> Rails 上で動く CMS LocomotiveCMS を使ってみる。 - xxxcaqui.log
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[emacs の org-mode で octopress を更新する]]></title>
    <link href="http://kixonn.github.io/blog/2013/07/13/org-on-octopress/"/>
    <updated>2013-07-13T01:26:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/07/13/org-on-octopress</id>
    <content type="html"><![CDATA[<p>
org-mode で、 octopress を記述する方法をまとめようとしていて、めとめられていなかったのでまとめてみた。
ちなみに、初期の頃からずっと org-mode で書いている。
すでに紹介されている方法 <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> と差分が少しあったので注意。
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">導入</h2>
<div class="outline-text-2" id="text-1">
<p>
octopress は何をやっているのかというと、 markdown 記法で書かれた <code>.markdown</code> ファイルを投稿しているらしい。
それで、 org-mode を用いて octopress には emacs の org-mode で作成したファイルを markdown 記法のファイルに変換してあげようという話。
octopress と emacs 24.2 以降の導入が完了していることを前提に話を進める。
</p>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">準備</h2>
<div class="outline-text-2" id="text-2">
<p>
org-mode 記法のファイルを markdown で出力して、それを <code>rake gen_deploy</code> すればよいというおはなしで、特に octopress 側の設定について触る必要はないのだけれど、 <code>rake new_post</code> したときに雛形の .org ファイルが生成されれば嬉しいよね。ということで、そのようにするように <code>Rakefile</code> に以下の変更を加える。
</p>
<figure class='code'><figcaption><span> (Rakefile.patch)</span> <a href='http://kixonn.github.io/downloads/code/./20130713/Rakefile.patch'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">---</span> <span class="no">Rakefile</span>
</span><span class='line'><span class="o">+++</span> <span class="no">Rakefile</span><span class="o">.</span><span class="n">orig</span>
</span><span class='line'><span class="err">@@</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">25</span> <span class="o">+</span><span class="mi">9</span><span class="p">,</span><span class="mi">22</span> <span class="err">@@</span>
</span><span class='line'> <span class="n">document_root</span>  <span class="o">=</span> <span class="s2">&quot;~/website.com/&quot;</span>
</span><span class='line'> <span class="n">rsync_delete</span>   <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'> <span class="n">rsync_args</span>     <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># Any extra arguments to pass to rsync</span>
</span><span class='line'><span class="o">-</span><span class="n">deploy_default</span> <span class="o">=</span> <span class="s2">&quot;push&quot;</span>
</span><span class='line'><span class="o">+</span><span class="n">deploy_default</span> <span class="o">=</span> <span class="s2">&quot;rsync&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">## -- Misc Configs -- ##</span>
</span><span class='line'>
</span><span class='line'> <span class="n">stash_dir</span>       <span class="o">=</span> <span class="s2">&quot;_stash&quot;</span>    <span class="c1"># directory to stash posts for speedy generation</span>
</span><span class='line'> <span class="n">posts_dir</span>       <span class="o">=</span> <span class="s2">&quot;_posts&quot;</span>    <span class="c1"># directory for blog files</span>
</span><span class='line'><span class="o">-</span><span class="n">org_posts_dir</span>   <span class="o">=</span> <span class="s2">&quot;org_posts&quot;</span>
</span><span class='line'> <span class="n">themes_dir</span>      <span class="o">=</span> <span class="s2">&quot;.themes&quot;</span>   <span class="c1"># directory for blog files</span>
</span><span class='line'><span class="o">-</span><span class="c1"># new_post_ext    = &quot;markdown&quot;  # default new post file extension when using the new_post task</span>
</span><span class='line'><span class="o">-</span><span class="c1"># new_page_ext    = &quot;markdown&quot;  # default new page file extension when using the new_page task</span>
</span><span class='line'><span class="o">-</span><span class="n">new_post_ext</span>    <span class="o">=</span> <span class="s2">&quot;org&quot;</span>  <span class="c1"># default new post file extension when using the new_post task</span>
</span><span class='line'><span class="o">-</span><span class="n">new_page_ext</span>    <span class="o">=</span> <span class="s2">&quot;org&quot;</span>  <span class="c1"># default new page file extension when using the new_page task</span>
</span><span class='line'><span class="o">+</span><span class="n">new_post_ext</span>    <span class="o">=</span> <span class="s2">&quot;markdown&quot;</span>  <span class="c1"># default new post file extension when using the new_post task</span>
</span><span class='line'><span class="o">+</span><span class="n">new_page_ext</span>    <span class="o">=</span> <span class="s2">&quot;markdown&quot;</span>  <span class="c1"># default new page file extension when using the new_page task</span>
</span><span class='line'> <span class="n">server_port</span>     <span class="o">=</span> <span class="s2">&quot;4000&quot;</span>      <span class="c1"># port for preview server eg. localhost:4000</span>
</span><span class='line'>
</span><span class='line'><span class="err">@@</span> <span class="o">-</span><span class="mi">101</span><span class="p">,</span><span class="mi">16</span> <span class="o">+</span><span class="mi">98</span><span class="p">,</span><span class="mi">13</span> <span class="err">@@</span>
</span><span class='line'>     <span class="n">title</span> <span class="o">=</span> <span class="n">get_stdin</span><span class="p">(</span><span class="s2">&quot;Enter a title for your post: &quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'>   <span class="k">raise</span> <span class="s2">&quot;### You haven&#39;t set anything up yet. First run `rake install` to set up an Octopress theme.&quot;</span> <span class="k">unless</span> <span class="no">File</span><span class="o">.</span><span class="n">directory?</span><span class="p">(</span><span class="n">source_dir</span><span class="p">)</span>
</span><span class='line'><span class="o">-</span>  <span class="c1"># mkdir_p &quot;#{source_dir}/#{posts_dir}&quot;</span>
</span><span class='line'><span class="o">-</span>  <span class="n">mkdir_p</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">source_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">org_posts_dir</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="o">-</span>  <span class="c1"># filename = &quot;#{source_dir}/#{posts_dir}/#{Time.now.strftime(&#39;%Y-%m-%d&#39;)}-#{title.to_url}.#{new_post_ext}&quot;</span>
</span><span class='line'><span class="o">-</span>  <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">source_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">org_posts_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-%d&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">title</span><span class="o">.</span><span class="n">to_url</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="n">new_post_ext</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="o">+</span>  <span class="n">mkdir_p</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">source_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">posts_dir</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="o">+</span>  <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">source_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">posts_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-%d&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">title</span><span class="o">.</span><span class="n">to_url</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="n">new_post_ext</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>   <span class="k">if</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span class='line'>     <span class="nb">abort</span><span class="p">(</span><span class="s2">&quot;rake aborted!&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">ask</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> already exists. Do you want to overwrite?&quot;</span><span class="p">,</span> <span class="o">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="o">]</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'>   <span class="nb">puts</span> <span class="s2">&quot;Creating new post: </span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>   <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">post</span><span class="o">|</span>
</span><span class='line'><span class="o">-</span>    <span class="n">post</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;#+BEGIN_HTML&quot;</span>
</span><span class='line'>     <span class="n">post</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;---&quot;</span>
</span><span class='line'>     <span class="n">post</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;layout: post&quot;</span>
</span><span class='line'>     <span class="n">post</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;title: </span><span class="se">\&quot;</span><span class="si">#{</span><span class="n">title</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/&amp;/</span><span class="p">,</span><span class="s1">&#39;&amp;amp;&#39;</span><span class="p">)</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</span><span class='line'><span class="err">@@</span> <span class="o">-</span><span class="mi">118</span><span class="p">,</span><span class="mi">7</span> <span class="o">+</span><span class="mi">112</span><span class="p">,</span><span class="mi">6</span> <span class="err">@@</span>
</span><span class='line'>     <span class="n">post</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;comments: true&quot;</span>
</span><span class='line'>     <span class="n">post</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;categories: &quot;</span>
</span><span class='line'>     <span class="n">post</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;---&quot;</span>
</span><span class='line'><span class="o">-</span>    <span class="n">post</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;#+END_HTML&quot;</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'> <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="err">@@</span> <span class="o">-</span><span class="mi">254</span><span class="p">,</span><span class="mi">18</span> <span class="o">+</span><span class="mi">247</span><span class="p">,</span><span class="mi">21</span> <span class="err">@@</span>
</span><span class='line'> <span class="n">desc</span> <span class="s2">&quot;deploy public directory to github pages&quot;</span>
</span><span class='line'> <span class="n">multitask</span> <span class="ss">:push</span> <span class="k">do</span>
</span><span class='line'>   <span class="nb">puts</span> <span class="s2">&quot;## Deploying branch to Github Pages &quot;</span>
</span><span class='line'><span class="o">+</span>  <span class="nb">puts</span> <span class="s2">&quot;## Pulling any updates from Github Pages &quot;</span>
</span><span class='line'><span class="o">+</span>  <span class="n">cd</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">deploy_dir</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
</span><span class='line'><span class="o">+</span>    <span class="nb">system</span> <span class="s2">&quot;git pull&quot;</span>
</span><span class='line'><span class="o">+</span>  <span class="k">end</span>
</span><span class='line'>   <span class="p">(</span><span class="no">Dir</span><span class="o">[</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">deploy_dir</span><span class="si">}</span><span class="s2">/*&quot;</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">rm_rf</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>   <span class="ss">Rake</span><span class="p">:</span><span class="ss">:Task</span><span class="o">[</span><span class="ss">:copydot</span><span class="o">].</span><span class="n">invoke</span><span class="p">(</span><span class="n">public_dir</span><span class="p">,</span> <span class="n">deploy_dir</span><span class="p">)</span>
</span><span class='line'><span class="o">-</span>  <span class="nb">puts</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## copying </span><span class="si">#{</span><span class="n">public_dir</span><span class="si">}</span><span class="s2"> to </span><span class="si">#{</span><span class="n">deploy_dir</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="o">+</span>  <span class="nb">puts</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## Copying </span><span class="si">#{</span><span class="n">public_dir</span><span class="si">}</span><span class="s2"> to </span><span class="si">#{</span><span class="n">deploy_dir</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>   <span class="n">cp_r</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">public_dir</span><span class="si">}</span><span class="s2">/.&quot;</span><span class="p">,</span> <span class="n">deploy_dir</span>
</span><span class='line'>   <span class="n">cd</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">deploy_dir</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">do</span>
</span><span class='line'><span class="o">-</span>    <span class="nb">system</span> <span class="s2">&quot;git add .&quot;</span>
</span><span class='line'><span class="o">-</span>    <span class="nb">system</span> <span class="s2">&quot;git add -u&quot;</span>
</span><span class='line'><span class="o">+</span>    <span class="nb">system</span> <span class="s2">&quot;git add -A&quot;</span>
</span><span class='line'>     <span class="nb">puts</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## Commiting: Site updated at </span><span class="si">#{</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">utc</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>     <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Site updated at </span><span class="si">#{</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">utc</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>     <span class="nb">system</span> <span class="s2">&quot;git commit -m </span><span class="se">\&quot;</span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</span><span class='line'>     <span class="nb">puts</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## Pushing generated </span><span class="si">#{</span><span class="n">deploy_dir</span><span class="si">}</span><span class="s2"> website&quot;</span>
</span><span class='line'><span class="o">-</span>    <span class="nb">system</span> <span class="s2">&quot;git push origin </span><span class="si">#{</span><span class="n">deploy_branch</span><span class="si">}</span><span class="s2"> --force&quot;</span>
</span><span class='line'><span class="o">+</span>    <span class="nb">system</span> <span class="s2">&quot;git push origin </span><span class="si">#{</span><span class="n">deploy_branch</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>     <span class="nb">puts</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## Github Pages deploy complete&quot;</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'> <span class="k">end</span>
</span><span class='line'><span class="err">@@</span> <span class="o">-</span><span class="mi">312</span><span class="p">,</span><span class="mi">9</span> <span class="o">+</span><span class="mi">308</span><span class="p">,</span><span class="mi">15</span> <span class="err">@@</span>
</span><span class='line'>   <span class="k">else</span>
</span><span class='line'>     <span class="nb">puts</span> <span class="s2">&quot;Enter the read/write url for your repository&quot;</span>
</span><span class='line'>     <span class="nb">puts</span> <span class="s2">&quot;(For example, &#39;git@github.com:your_username/your_username.github.io)&quot;</span>
</span><span class='line'><span class="o">+</span>    <span class="nb">puts</span> <span class="s2">&quot;           or &#39;https://github.com/your_username/your_username.github.io&#39;)&quot;</span>
</span><span class='line'>     <span class="n">repo_url</span> <span class="o">=</span> <span class="n">get_stdin</span><span class="p">(</span><span class="s2">&quot;Repository url: &quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'><span class="o">-</span>  <span class="n">user</span> <span class="o">=</span> <span class="n">repo_url</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sr">/:([^\/]+)/</span><span class="p">)</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'><span class="o">+</span>  <span class="n">protocol</span> <span class="o">=</span> <span class="p">(</span><span class="n">repo_url</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sr">/(^git)@/</span><span class="p">)</span><span class="o">.</span><span class="n">nil?</span><span class="p">)</span> <span class="p">?</span> <span class="s1">&#39;https&#39;</span> <span class="p">:</span> <span class="s1">&#39;git&#39;</span>
</span><span class='line'><span class="o">+</span>  <span class="k">if</span> <span class="n">protocol</span> <span class="o">==</span> <span class="s1">&#39;git&#39;</span>
</span><span class='line'><span class="o">+</span>    <span class="n">user</span> <span class="o">=</span> <span class="n">repo_url</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sr">/:([^\/]+)/</span><span class="p">)</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'><span class="o">+</span>  <span class="k">else</span>
</span><span class='line'><span class="o">+</span>    <span class="n">user</span> <span class="o">=</span> <span class="n">repo_url</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sr">/github\.com\/([^\/]+)/</span><span class="p">)</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'><span class="o">+</span>  <span class="k">end</span>
</span><span class='line'>   <span class="n">branch</span> <span class="o">=</span> <span class="p">(</span><span class="n">repo_url</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sr">/\/[\w-]+\.github\.(?:io|com)/</span><span class="p">)</span><span class="o">.</span><span class="n">nil?</span><span class="p">)</span> <span class="p">?</span> <span class="s1">&#39;gh-pages&#39;</span> <span class="p">:</span> <span class="s1">&#39;master&#39;</span>
</span><span class='line'>   <span class="n">project</span> <span class="o">=</span> <span class="p">(</span><span class="n">branch</span> <span class="o">==</span> <span class="s1">&#39;gh-pages&#39;</span><span class="p">)</span> <span class="p">?</span> <span class="n">repo_url</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sr">/\/([^\.]+)/</span><span class="p">)</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="p">:</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'>   <span class="k">unless</span> <span class="p">(</span><span class="sb">`git remote -v`</span> <span class="o">=~</span> <span class="sr">/origin.+?octopress(?:\.git)?/</span><span class="p">)</span><span class="o">.</span><span class="n">nil?</span>
</span></code></pre></td></tr></table></div></figure>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">記事を作成</h2>
<div class="outline-text-2" id="text-3">
<pre class="example">
$ rake new_post
Enter a title for your post: org_on_octopress
mkdir -p source/org_posts
Creating new post: source/org_posts/2013-07-13-org-on-octopress.org
</pre>
<p>
すると、 <code>./source/org_posts/</code> 以下に記事の雛形となるファイルが作成される。
<code>./source/_posts/</code> 以下に変更は加わらない。
<code>./source/org_posts/</code> の <code>.org</code> ファイルを編集して、 <code>C-c</code> <code>C-e</code> <code>P</code> <code>f</code> で <code>./source/_posts/</code> 以下に <code>markdown</code> 記法に変換したファイルを出力できる。
<code>.markdown</code> のファイルが出来てしまえばあとは通常通りで、
</p>

<pre class="example">
$ rake gen_deploy
</pre>

<p>
すればよいだけ。おわり。
</p>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">参照</h2>
<div class="outline-text-2" id="text-4">
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://yunojy.github.io/blog/2013/02/11/emacs-de-github-blog-sono2-org-mode/">http://yunojy.github.io/blog/2013/02/11/emacs-de-github-blog-sono2-org-mode/</a> &#8220;emacs@がんばらない。なまけもの必見！今度こそ継続できる Blog を 10 分でGithub に開設する。もちろん無料 - org-mode 編 - develog.me&#8221;
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[C++11 の std::regex_iterator について]]></title>
    <link href="http://kixonn.github.io/blog/2013/07/11/split-by-regex-iterator-cpp/"/>
    <updated>2013-07-11T15:19:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/07/11/split-by-regex-iterator-cpp</id>
    <content type="html"><![CDATA[<p>
最近、 C++11 まわりを色々と調べていて、標準の正規表現ライブラリ <code>std::regex</code> に関するメモ。
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">準備</h2>
<div class="outline-text-2" id="text-1">
<p>
clang 3.3 にて C++11 がフルサポートされているので、 accept<sub>keyword</sub> に追加して emerge する。
clang はオプションを付与しないと gcc の標準ライブラリを見に行くので、 libcxx も emerge しておく。
</p>

<pre class="example">
# emerge =clang-3.3 libcxx --autounmask-write
# etc-update
# emerge =clang-3.3 libcxx
</pre>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">文字列の分割</h2>
<div class="outline-text-2" id="text-2">
<p>
C++03 までは、 boost を使用せずに文字列の分割を行うのであれば、例えばスペースで文字列を区切る場合、以下のように自分で一から書くというのがセオリーの一つだった <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 。
</p>

<figure class='code'><figcaption><span> (split_string01.cc)</span> <a href='http://kixonn.github.io/downloads/code/20130711/split_string01.cc'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &lt;iostream&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string&gt;</span>
</span><span class='line'><span class="cp">#include &lt;vector&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">split</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="o">&amp;</span><span class="n">str</span><span class="p">,</span> <span class="kt">char</span> <span class="n">delim</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">string</span> <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Thu Jan  1 00:00:00 UTC 1970&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">vec</span> <span class="o">=</span> <span class="n">split</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="sc">&#39; &#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">vec</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">vec</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">it</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">split</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="o">&amp;</span><span class="n">str</span><span class="p">,</span> <span class="kt">char</span> <span class="n">delim</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">res</span><span class="p">;</span>
</span><span class='line'>  <span class="n">size_t</span> <span class="n">current</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">found</span><span class="p">;</span>
</span><span class='line'>  <span class="k">while</span><span class="p">((</span><span class="n">found</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">find_first_of</span><span class="p">(</span><span class="n">delim</span><span class="p">,</span> <span class="n">current</span><span class="p">))</span> <span class="o">!=</span> <span class="n">string</span><span class="o">::</span><span class="n">npos</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="n">found</span> <span class="o">-</span> <span class="n">current</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">found</span> <span class="o">-</span> <span class="n">current</span><span class="p">));</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="n">current</span> <span class="o">=</span> <span class="n">found</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">current</span><span class="p">,</span> <span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="n">current</span><span class="p">));</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>
C++11 からは標準正規表現ライブラリ <code>std::regex</code> を通して、以下のように書くことができる <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup> 。
</p>

<figure class='code'><figcaption><span> (split_string02.cc)</span> <a href='http://kixonn.github.io/downloads/code/20130711/split_string02.cc'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &lt;iostream&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string&gt;</span>
</span><span class='line'><span class="cp">#include &lt;regex&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="n">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">string</span> <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Thu Jan  1 00:00:00 UTC 1970&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="n">regex</span> <span class="n">ws_re</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">s+&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">sregex_token_iterator</span> <span class="n">it_begin</span> <span class="o">=</span> <span class="n">sregex_token_iterator</span><span class="p">(</span><span class="n">text</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">text</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">ws_re</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>  <span class="n">sregex_token_iterator</span> <span class="n">it_end</span> <span class="o">=</span> <span class="n">sregex_token_iterator</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span><span class="p">(</span><span class="n">sregex_token_iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">it_begin</span><span class="p">;</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">it_end</span><span class="p">;</span> <span class="n">it</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">it</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>

<p>
綺麗で見易いですよね。ちなみに、以下のように書くとハマるので注意が必要。
</p>

<figure class='code'><figcaption><span> (split_string02_dumb.cc)</span> <a href='http://kixonn.github.io/downloads/code/20130711/split_string02_dumb.cc'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'>  <span class="n">sregex_token_iterator</span> <span class="n">it_begin</span> <span class="o">=</span> <span class="n">sregex_token_iterator</span> <span class="p">(</span><span class="n">text</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">text</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">regex</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">s+&quot;</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://shnya.jp/blog/?p=195">http://shnya.jp/blog/?p=195</a> C++ で文字列の split | Story of Your Life
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="http://www.cplusplus.com/reference/regex/regex_token_iterator/regex_token_iterator/">http://www.cplusplus.com/reference/regex/regex_token_iterator/regex_token_iterator/</a> regex<sub>token</sub><sub>iterator</sub>::regex<sub>token</sub><sub>iterat</sub>&#x2026; - C++ Reference
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[IMAP フォルダ名をデコードする]]></title>
    <link href="http://kixonn.github.io/blog/2013/06/26/imap-folder-encoding/"/>
    <updated>2013-06-26T20:26:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/06/26/imap-folder-encoding</id>
    <content type="html"><![CDATA[<p>
先日、設定した mu4e について、 Gmail アカウントを扱おうとすると、 IMAP フォルダが文字化けする事案が発生していたので、これを修正。
結論からいえば Gmail の設定から [言語] を [English (US)] とかに変更すれば、 再度、 <code>offlineimap</code> 実行したときに <code>&amp;U9dP4TDIMOwwpA0 (受信トレイ)</code> といったローカルの IMAP フォルダでの表示が <code>INBOX</code> といった Ascii 文字に変更されるので、きれいに解決したいのであればそのような対応で問題ない。
けれども、 Gmail の表示言語を日本語のまま、使うには上記では問題がある (クライアントセットアップしてるのにそんなことある必要性があるかどうかは別として) ．
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">UTF-7 文字のデコード</h2>
<div class="outline-text-2" id="text-1">
<p>
国際的なメールボックス名は <a href="http://www.lins.jp/~obata/imap/rfc/rfc2060ja.html#s5.1.3">RFC 2060</a> 標準化規格によって、 UTF-7 でエンコードされているので、実際のフォルダ名を知るにはこれをデコードしなければならない。
Ruby を用いてデコードするには以下でよいらしい <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 。
</p>

<figure class='code'><figcaption><span> (bash)</span> <a href='http://kixonn.github.io/downloads/code/20130626/bash'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>ruby -r net/imap -e <span class="s1">&#39;puts Net::IMAP.decode_utf7 (&quot;&amp;U9dP4TDIMOwwpA-&quot;)&#39;</span>
</span><span class='line'>受信トレイ
</span><span class='line'><span class="nv">$ </span>ruby -r net/imap -e <span class="s1">&#39;puts Net::IMAP.encode_utf7 (&quot;受信トレイ&quot;)&#39;</span>
</span><span class='line'>&amp;U9dP4TDIMOwwpA-
</span></code></pre></td></tr></table></div></figure>


<p>
それで、以下のような感じで、 <code>emacs.el</code> に設定すればよいのだけれど。
</p>
<figure class='code'><figcaption><span> (emacs)</span> <a href='http://kixonn.github.io/downloads/code/20130626/emacs'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-inbox-folder</span> <span class="s">&quot;/Gmail/&amp;U9dP4TDIMOwwpA-&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>
<p>
これだと、フォルダ移動のときのフォルダ名入力のときに面倒なので、エイリアス作成するか本を正せば Gmail の言語を変更した方がよい。
</p>
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://star.ap.teacup.com/1yen/1063.html">http://star.ap.teacup.com/1yen/1063.html</a> IMAP の日本語フォルダ | どんなことでも
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[複数アカウントを mu4e で扱うときの設定]]></title>
    <link href="http://kixonn.github.io/blog/2013/06/15/mu4e-settings/"/>
    <updated>2013-06-15T01:35:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/06/15/mu4e-settings</id>
    <content type="html"><![CDATA[<p>
メーラといえば、今日まで emacs の mew を使っていたのだけれど、メールの作成時にファイルを添付して送信しようとするとミニバッファに <code>nil</code> とだけ表示されてファイルを添付したメールを作成することができなかった。
いつもはファイルを添付したメールを作成するときには、わざわざ sylpheed を使っていたのだけれど受信箱にあるメールに対して返信メールを書こうとすると、プロセスが反応しなくなってしまうという問題が最近になって、発生するようになってしまった。
そこで、この際メールクライアントを刷新しようと思ったのだけれど、候補としては GUI のものは用いたくなかった (GUI は基本的に重いし、 mew を使っているとキーボードで操作できないことに使い心地の悪さを感じる) ので、ハッカーに代表されるツールとして定評のある mutt を選んでみた。
</p>




<p>
fetchmail + procmail + mutt な環境を三日ぐらいかけて構築したはよいものの、 mew のように受信したメールを見ながら返信を書くことができなかったり、エディタに emacs を設定しても編集しづらかったり、カスタマイズするべき項目が多すぎたりしたために、さらに別のクライアントを探してみた。
それで、 @myuhe さんが mu4e について言及されていたのをふと思いだしたので、導入してみた。
結果、結構よい感じに使用できているので導入手順と設定をメモ。
</p>




<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">パッケージインストール</h2>
<div class="outline-text-2" id="text-1">
<p>
あらかじめ use フラグに <code>emacs</code> <code>ssl</code> を追加しておく。
マニュアル <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> を見て依存するパッケージを確認して、インストールする。
</p>

<pre class="example">
# emerge gmime xapian mu offlineimap
</pre>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">offlineimap の設定</h2>
<div class="outline-text-2" id="text-2">
<p>
基本的に mu4e は mu をバインドしてメールを閲覧するものであるため、メールは別で取得してくる必要がある。
それを行ってくれるのが offlineimap コマンドで、取得先のメールサーバの設定、メールの保存先を指定する設定ファイルが <code>.offlineimaprc</code> 。
以下に複数アカウントを扱うサンプルファイルを記しておく。
</p>

<figure class='code'><figcaption><span> (offlineimaprc)</span> <a href='http://kixonn.github.io/downloads/code/20130615/offlineimaprc'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>general<span class="o">]</span>
</span><span class='line'><span class="nv">accounts</span> <span class="o">=</span> Main
</span><span class='line'><span class="nv">maxsyncaccounts</span> <span class="o">=</span> 3
</span><span class='line'>
</span><span class='line'><span class="o">[</span>Account Main<span class="o">]</span>
</span><span class='line'><span class="nv">localrepository</span> <span class="o">=</span> LocalMain
</span><span class='line'><span class="nv">remoterepository</span> <span class="o">=</span> RemoteMain
</span><span class='line'>
</span><span class='line'><span class="o">[</span>Repository LocalMain<span class="o">]</span>
</span><span class='line'><span class="nb">type</span> <span class="o">=</span> Maildir
</span><span class='line'><span class="nv">localfolders</span> <span class="o">=</span> ~/Maildir/Main
</span><span class='line'>
</span><span class='line'><span class="o">[</span>Repository RemoteMain<span class="o">]</span>
</span><span class='line'><span class="nb">type</span> <span class="o">=</span> IMAP
</span><span class='line'><span class="nv">remotehost</span> <span class="o">=</span> main.co.jp
</span><span class='line'><span class="nv">remoteuser</span> <span class="o">=</span> kdkk-
</span><span class='line'><span class="nv">remotepass</span> <span class="o">=</span> ********
</span><span class='line'><span class="nv">ssl</span> <span class="o">=</span> yes
</span><span class='line'><span class="nv">cert_fingerprint</span> <span class="o">=</span> ****************************************
</span><span class='line'><span class="nv">maxconnections</span> <span class="o">=</span> 1
</span><span class='line'><span class="nv">realdelete</span> <span class="o">=</span> no
</span><span class='line'>
</span><span class='line'><span class="o">[</span>Account Gmail<span class="o">]</span>
</span><span class='line'><span class="nv">localrepository</span> <span class="o">=</span> LocalGmail
</span><span class='line'><span class="nv">remoterepository</span> <span class="o">=</span> RemoteGmail
</span><span class='line'>
</span><span class='line'><span class="o">[</span>Repository LocalGmail<span class="o">]</span>
</span><span class='line'><span class="nb">type</span> <span class="o">=</span> Maildir
</span><span class='line'><span class="nv">localfolders</span> <span class="o">=</span> ~/Maildir/Gmail
</span><span class='line'>
</span><span class='line'><span class="o">[</span>Repository RemoteGmail<span class="o">]</span>
</span><span class='line'><span class="nb">type</span> <span class="o">=</span> IMAP
</span><span class='line'><span class="nv">remotehost</span> <span class="o">=</span> imap.gmail.com
</span><span class='line'><span class="nv">remoteuser</span> <span class="o">=</span> ********@gmail.com
</span><span class='line'><span class="nv">remotepass</span> <span class="o">=</span> ********
</span><span class='line'><span class="nv">ssl</span> <span class="o">=</span> yes
</span><span class='line'><span class="nv">cert_fingerprint</span> <span class="o">=</span> ****************************************
</span><span class='line'><span class="nv">maxconnections</span> <span class="o">=</span> 1
</span><span class='line'><span class="nv">realdelete</span> <span class="o">=</span> no
</span></code></pre></td></tr></table></div></figure>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">offlineimpap の実行</h2>
<div class="outline-text-2" id="text-3">
<p>
offlineimap の設定が完了したら以下のコマンドを実行して、メールを imap メールサーバから取得し、インデックスを作成しておく。
</p>
<pre class="example">
$ imapoffline # [general] の accounts で設定されているアカウントからのメールを取得
$ imapoffline -a gMail
$ mu index    # インデックスの作成
</pre>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">mu4e の設定</h2>
<div class="outline-text-2" id="text-4">
<p>
以下を <code>.emacs.el</code> に書く。複数アカウントを扱う方法はマニュアルを参照 <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup> 。
</p>
<figure class='code'><figcaption><span> (mu4e_config.el)</span> <a href='http://kixonn.github.io/downloads/code/20130615/mu4e_config.el'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;mu4e</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;smtpmail</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-use-fancy-chars</span> <span class="nv">nil</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-attachment-dir</span> <span class="s">&quot;~/Downloads&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-view-show-images</span> <span class="nv">t</span>
</span><span class='line'>      <span class="nv">mu4e-view-image-max-width</span> <span class="mi">800</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">set-language-environment</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">message-kill-buffer-on-exit</span> <span class="nv">t</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-maildir</span> <span class="s">&quot;~/Maildir&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">message-send-mail-function</span> <span class="ss">&#39;smtpmail-send-it</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">defvar</span> <span class="nv">my-mu4e-account-alist</span>
</span><span class='line'>      <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;Main&quot;</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">user-mail-address</span> <span class="s">&quot;kdkk-@main.co.jp&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-inbox-folder</span> <span class="s">&quot;/Main/INBOX&quot;</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">mu4e-sent-folder</span> <span class="s">&quot;/Main/Sent&quot;</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">mu4e-drafts-folder</span> <span class="s">&quot;/Main/Drafts&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-trash-folder</span>  <span class="s">&quot;/Main/Trash&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-get-mail-command</span> <span class="s">&quot;offlineimap&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-update-interval</span> <span class="mi">300</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">user-full-name</span>  <span class="s">&quot;kdkk-&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">smtpmail-debug-info</span> <span class="nv">t</span><span class="p">)</span> <span class="c1">; only to debug problems</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">smtpmail-stream-type</span> <span class="nv">ssl</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">starttls-use-gnutls</span> <span class="nv">nil</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">smtpmail-smtp-server</span> <span class="s">&quot;main.co.jp&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">smtpmail-smtp-service</span> <span class="mi">465</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">message-signature</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">concat</span>
</span><span class='line'>     <span class="s">&quot;kdkk-&lt;kdkk-@main.co.jp&gt;&quot;</span>
</span><span class='line'>     <span class="s">&quot;\n&quot;</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="s">&quot;Gmail&quot;</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-inbox-folder</span> <span class="s">&quot;/Gmail/INBOX&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-drafts-folder</span> <span class="s">&quot;/[Gmail].Drafts&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-sent-folder</span>   <span class="s">&quot;/[Gmail].Sent Mail&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-trash-folder</span>  <span class="s">&quot;/[Gmail].Trash&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-get-mail-command</span> <span class="s">&quot;offlineimap -a Gmail&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mu4e-update-interval</span> <span class="mi">300</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">user-mail-address</span> <span class="s">&quot;****@gmail.com&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">starttls-use-gnutls</span> <span class="nv">t</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">smtpmail-default-smtp-server</span> <span class="s">&quot;smtp.gmail.com&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">smtpmail-smtp-server</span> <span class="s">&quot;smtp.gmail.com&quot;</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">smtpmail-smtp-service</span> <span class="mi">587</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">message-signature</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">concat</span>
</span><span class='line'>     <span class="s">&quot;kdkk-&lt;****@gmail.com&gt;&quot;</span>
</span><span class='line'>     <span class="s">&quot;\n&quot;</span><span class="p">)))</span>
</span><span class='line'><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defun</span> <span class="nv">my-mu4e-set-account</span> <span class="p">()</span>
</span><span class='line'>  <span class="s">&quot;Set the account for composing a message.&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let* </span><span class="p">((</span><span class="nf">account</span>
</span><span class='line'>    <span class="p">(</span><span class="k">if </span><span class="nv">mu4e-compose-parent-message</span>
</span><span class='line'>        <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">maildir</span> <span class="p">(</span><span class="nf">mu4e-message-field</span> <span class="nv">mu4e-compose-parent-message</span> <span class="nv">:maildir</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">string-match</span> <span class="s">&quot;/\\(.*?\\)/&quot;</span> <span class="nv">maildir</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">match-string</span> <span class="mi">1</span> <span class="nv">maildir</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">completing-read</span> <span class="p">(</span><span class="nf">format</span> <span class="s">&quot;Compose with account: (%s) &quot;</span>
</span><span class='line'>                   <span class="p">(</span><span class="nf">mapconcat</span> <span class="o">#&#39;</span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">var</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">var</span><span class="p">))</span> <span class="nv">my-mu4e-account-alist</span> <span class="s">&quot;/&quot;</span><span class="p">))</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">mapcar</span> <span class="o">#&#39;</span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">var</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">var</span><span class="p">))</span> <span class="nv">my-mu4e-account-alist</span><span class="p">)</span>
</span><span class='line'>               <span class="nv">nil</span> <span class="nv">t</span> <span class="nv">nil</span> <span class="nv">nil</span> <span class="p">(</span><span class="nb">caar </span><span class="nv">my-mu4e-account-alist</span><span class="p">))))</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">account-vars</span> <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">assoc </span><span class="nv">account</span> <span class="nv">my-mu4e-account-alist</span><span class="p">))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">if </span><span class="nv">account-vars</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">mapc</span> <span class="o">#&#39;</span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">var</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">set</span> <span class="p">(</span><span class="nb">car </span><span class="nv">var</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr </span><span class="nv">var</span><span class="p">)))</span>
</span><span class='line'>        <span class="nv">account-vars</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">error</span> <span class="s">&quot;No email account found&quot;</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">add-hook</span> <span class="ss">&#39;mu4e-compose-pre-hook</span> <span class="ss">&#39;my-mu4e-set-account</span><span class="p">)</span>
</span><span class='line'><span class="c1">;; don&#39;t save message to Sent Messages, Gmail/IMAP takes care of this</span>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-sent-messages-behavior</span> <span class="ss">&#39;delete</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;; setup some handy shortcuts</span>
</span><span class='line'><span class="c1">;; you can quickly switch to your Inbox -- press ``ji&#39;&#39;</span>
</span><span class='line'><span class="c1">;; then, when you want archive some messages, move them to</span>
</span><span class='line'><span class="c1">;; the &#39;All Mail&#39; folder by pressing ``ma&#39;&#39;.</span>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">mu4e-maildir-shortcuts</span>
</span><span class='line'>      <span class="o">&#39;</span><span class="p">(</span> <span class="p">(</span><span class="s">&quot;/Main/INBOX&quot;</span> <span class="o">.</span> <span class="nv">?i</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="s">&quot;/Gmail/INBOX&quot;</span> <span class="o">.</span> <span class="nv">?g</span><span class="p">)</span>
</span><span class='line'><span class="p">))</span>
</span><span class='line'><span class="c1">;; Attach_File_with_Dired</span>
</span><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="ss">&#39;gnus-dired</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">defun</span> <span class="nv">gnus-dired-mail-buffers</span> <span class="p">()</span>
</span><span class='line'>  <span class="s">&quot;Return a list of active message buffers.&quot;</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">(</span><span class="nf">buffers</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">save-current-buffer</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">dolist</span> <span class="p">(</span><span class="nf">buffer</span> <span class="p">(</span><span class="nf">buffer-list</span> <span class="nv">t</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">set-buffer</span> <span class="nv">buffer</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">when</span> <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">derived-mode-p</span> <span class="ss">&#39;message-mode</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">null</span> <span class="nv">message-sent-message-via</span><span class="p">))</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">push</span> <span class="p">(</span><span class="nf">buffer-name</span> <span class="nv">buffer</span><span class="p">)</span> <span class="nv">buffers</span><span class="p">))))</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">nreverse</span> <span class="nv">buffers</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">setq</span> <span class="nv">gnus-dired-mail-mode</span> <span class="ss">&#39;mu4e-user-agent</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">add-hook</span> <span class="ss">&#39;dired-mode-hook</span> <span class="ss">&#39;turn-on-gnus-dired-mode</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>
</div>
</div>


<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">mu4e を使う</h2>
<div class="outline-text-2" id="text-5">
<p>
<code>M-x</code> を押して、 <code>mu4e</code> を打って <code>RET</code> 。
あとは指示通りに使えばよい。 smtp を ssl から送信する方法がよく分からなくて詰んでた。マニュアルにも見当たらなかったので手探り状態。
587 ポートは管理者じゃないので変更できない状態でした。
</p>
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://www.djcbsoftware.nl/code/mu/mu4e/Installation.html#Installation">http://www.djcbsoftware.nl/code/mu/mu4e/Installation.html#Installation</a> &#8220;Installation - mu4e user manual&#8221;
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="http://www.djcbsoftware.nl/code/mu/mu4e/Multiple-accounts.html#Multiple-accounts">http://www.djcbsoftware.nl/code/mu/mu4e/Multiple-accounts.html#Multiple-accounts</a> &#8220;Multiple accounts - mu4e user manual&#8221;
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[pdf ファイルの印刷を不可設定にする]]></title>
    <link href="http://kixonn.github.io/blog/2013/06/04/denied-printing-pdf-file/"/>
    <updated>2013-06-04T11:00:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/06/04/denied-printing-pdf-file</id>
    <content type="html"><![CDATA[<p>
pdf ファイルの印刷を許可しないように設定しなければならない案件があったので、メモ。
結論だけ、言うと <code>pdftk</code> で以下のコマンドを叩いてやるとできる。
</p>


<pre class="example">
pdftk input.pdf output output.pdf owner_pw hogehoge
</pre>




<p>
どうせやるなら、ランダムな文字列をパスワードに設定したいので以下のシェルスクリプトにまとめてみた。
</p>




<p>
なお、ランダムな文字列を生成するシェルスクリプトは <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> から拝借した。
</p>




<figure class='code'><figcaption><span> (pdftkpw.sh)</span> <a href='http://kixonn.github.io/downloads/code/20130604/pdftkpw.sh'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="nv">PDFIN</span><span class="o">=</span><span class="nv">$1</span>
</span><span class='line'><span class="nv">PDFOUT</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$1</span> | sed -e <span class="s2">&quot;s/\.[^.]*$/pw.pdf/&quot;</span><span class="sb">`</span>
</span><span class='line'><span class="nv">len</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$RANDOM</span> % 5 + 14 | bc<span class="sb">`</span>
</span><span class='line'>
</span><span class='line'><span class="o">[</span> -z <span class="nv">$len</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">len</span><span class="o">=</span><span class="s2">&quot;8&quot;</span>
</span><span class='line'><span class="nv">char</span><span class="o">=</span><span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890&#39;</span>;
</span><span class='line'><span class="nv">i</span><span class="o">=</span>1
</span><span class='line'><span class="k">while</span> <span class="o">[</span> <span class="nv">$i</span> -le <span class="nv">$len</span> <span class="o">]</span>; <span class="k">do</span>
</span><span class='line'><span class="k">    </span><span class="nv">dm</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span>RANDOM <span class="o">%</span> <span class="k">${#</span><span class="nv">char</span><span class="k">}</span><span class="o">)</span> <span class="k">))</span>
</span><span class='line'>        <span class="nv">str</span><span class="o">=</span><span class="s2">&quot;${str}${char:${dm}:1}&quot;</span>
</span><span class='line'>      <span class="nv">i</span><span class="o">=</span><span class="k">$((</span> i+1 <span class="k">))</span>
</span><span class='line'><span class="k">done</span>
</span><span class='line'>
</span><span class='line'><span class="nv">PW</span><span class="o">=</span><span class="s2">&quot;$str&quot;</span>
</span><span class='line'><span class="nv">PW</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;fjajfpsjpdsgs&quot;</span><span class="sb">`</span>
</span><span class='line'>pdftk <span class="nv">$PDFIN</span> output <span class="nv">$PDFOUT</span> owner_pw <span class="nv">$PW</span>
</span></code></pre></td></tr></table></div></figure>




<p>
生成した pdf ファイルが Evince から印刷できるので、おかしいなーと思ってハマっていたけど、そういうものらしい。
acroread からはちゃんと、印刷できないし、 Security の Allow Printing の項目も問題ない。
まー <code>pdfcrack</code> なるツールもあるので、気休め程度の対応。
</p>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://blog.paz-para.com/?p=1709">http://blog.paz-para.com/?p=1709</a> blog.paz-para.com » Blog Archive » シェルスクリプトでパスワード生成
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DirectFB 上で gtk+/Qt などの GUI アプリケーションを常用してはいけない理由]]></title>
    <link href="http://kixonn.github.io/blog/2013/05/31/reason-keep-to-using-x/"/>
    <updated>2013-05-31T23:30:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/05/31/reason-keep-to-using-x</id>
    <content type="html"><![CDATA[<p>
DirectFB はフレームバッファ上に、描画 API を提供するライブラリなのだけれど、 DirectFB の API を利用することによって、 フレームバッファ上に gtk+ アプリケーションを立ち上げることのできる Gtk-DFB <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> というのがある。
この主な用途としては OS のインストールに際して、 GUI インストーラを使用する際にこれを立ち上げたり、組込みデバイスにおいて GUI アプリケーションを立ち上げるサポートを行ったりするらしい。
</p>




<p>
でも、 X 重いしデスクトップ環境でも GTK アプリケーションしか使わないんなら Gtk-DFB を常用しても構わないんじゃないの? とか思うわけなのだけれど、同じ質問が stackoverflow <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup> で投稿されていたのでまとめてみた。
</p>




<p>
以下、 Stack Overflow からの引用、和訳。
</p>




<blockquote>
<p>
Havoc P の回答 (意訳):
</p>

<p>
X は最近の携帯電話よりもはるかに劣る計算機の時代に開発されたものなんだ。
だから、すでに使われていない様々な機能を未だに持っていたりするし，そのためにピクセルを描画するための機能が最適化されていないから、オーバーヘッドが大きいのは仕方がないことなんだ。
</p>

<p>
また、 X はもともとクライアントとサーバ間のモデルを抱えていて、デスクトップ環境だとクライアントとサーバが同じマシンの上で動いているために、いまいちパフォーマンスが悪いんだ。
このパフォーマンスの低下はクライアントとサーバ間の通信が原因でそれが関係しないエクステンション (pixmaps, DRI, etc&#x2026;) はパフォーマンスの低下とあまり因果はないんだよ。
ただ、複数のプロセスがハードウェアに同一にアクセスすることがあるから、必ずしも X のソケット処理だけがネックであるとは限らないんだけどね。
</p>

<p>
だけど、ハードウェアに複数のプロセスがアクセスすることになるからこそ、プロセスのクラッシュを防ぐといった意味で X の利点というのはあるんだ。
Google Chrome について見てみると Google Chrome 上で複数のプロセスが走ることでメモリの使用量は大きくなるけれども、各プロセスが高速に動作することが示されている。
つまり、ただプロセス数が少なければそれらが高速に動作するというものではないんだよ。
</p>

<p>
DirectFB の API を利用して GTK アプリケーションを動作することが問題である理由はたくさんある。
例えば、 Firefox は大体、 X を経由して起動されるけど、 Firefox のブラウザプラグインには Firefox が描画に用いている Gtk+ を利用せず、例えば Adobe-Flash プラグインのような直接 X を用いて描画を行っているものがあるんだ。
他にも X を使用していないアプリケーションがあったとしてもその実行環境として、 Gnome や Xfce といった、結局は X に依存しているようなデスクトップ環境を想定しているものがあるんだ。
</p>

<p>
X を置換えることができない他の理由としてはドライバの存在がある。
nVidia のプロプライエタリなドライバはオープンソースのドライバより、パフォーマンスが高い状態で動作するけれども、これらは X に関連付けられていて、 X 無しで動作することができないんだ。
ソースコードも公開されていないから他に移植することもできないしね。
</p>

<p>
もちろん、移行の方法もあるけれど、 X と X の元で動作するデスクトップ環境等の上で動作する 100 以上のアプリを使用している場合、わざわざアプリが動作しない環境に移行しようとする人はいないだろう。
ほとんどの場合、新しいウィンドウシステム上でルートレスな X サーバを動作させることで古いアプリケーションを動作させることもできるんだ。 (Wayland のことカナァ)
</p>

<p>
古いものは決して悪ではなくて、 X は洗練されたウィンドウシステムであるんだ。
それに、より進化することで、今後、数年後も動作を保証するものでもあるんだよ。
</p>

<p>
とにかく僕が長々と言ってきたのは、今までのアプリがちゃんと動作する環境を作成したうえで X から離れるには膨大なコストを必要とするんだ。
そして、それは大体はハードウェアの問題だ。
</p>

<p>
X には様々な問題があって、 Wayland プロジェクトが目指しているようなアトミックな画面のアップデートなどがあるけれども、大体はユーザのための非アトミックなアップデートや開発者のために推奨されるような拡張機能のようなごまかしみたいなものなんだ。 ( atomic をどう訳せばいいのかワカラン)
ただ、 X を落として早さを手に入れればいいってもんじゃないんだ。
X はネットワークや古さに準拠することで再び安っぽいハードウェアのために設計されたんだ。
そう、私が X と emacs を 8MB の RAM で走らせているようにね。
</p>
</blockquote>




<p>
ネットワークや GPU 等のハードウェアや X に完全に依存しないインストーラ等のシングルタスクのアプリケーションであれば問題ないという理解でよいのだろうな。
</p>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://directfb.org/wiki/index.php/Projects:GTK_on_DirectFB">http://directfb.org/wiki/index.php/Projects:GTK_on_DirectFB</a> Projects:GTK on DirectFB - DirectFB
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="http://stackoverflow.com/questions/3327767/why-is-directfb-not-more-widely-used-in-gnu-linux-are-there-crippling-limitatio">http://stackoverflow.com/questions/3327767/why-is-directfb-not-more-widely-used-in-gnu-linux-are-there-crippling-limitatio</a> graphics - Why is DirectFB not more widely used in GNU/Linux? Are there crippling limitations to it that don&#8217;t exist in X11? - Stack Overflow
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[reveal.js を org 記法で!!]]></title>
    <link href="http://kixonn.github.io/blog/2013/05/28/write-revealjs-in-org-mode/"/>
    <updated>2013-05-28T23:00:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/05/28/write-revealjs-in-org-mode</id>
    <content type="html"><![CDATA[<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">はじめに</h2>
<div class="outline-text-2" id="text-1">
<p>
reveal.js を知らない方は <a href="http://lab.hakim.se/reveal-js/#/">reveal.js - The HTML Presentation Framework</a> を参照。
一時期、流行った impress.js<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 的な HTML5 プレゼンテーションツールみたいなもの。
</p>

<p>
impress.js はなんだか凝りすぎて結局のところ、テンプレのようなすごいスライドを作るのには js ガリガリ書けないといけないし、 GUI ツールも使いづらかったので断念していた。
reveal.js も似たようなもんだろーと思っていたところ、 markdown 記法で reveal.js 用のスライドを書くという記事 <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup> を発見したので、齧ってみることにした。
でも、 markdown で書けるなら org-mode で書きたいよねー (この記事も org-mode で生成してるし。。。) という話で、調べてみた。
</p>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">reveal.js</h2>
<div class="outline-text-2" id="text-2">
<p>
当然、必要なのでダウンロードしておく。
reveal.js の配置してあるパスは覚えておく。
</p>
<pre class="example">
$ git clone git://github.com/hakimel/reveal.js.git revealjs
</pre>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">org-reveal</h2>
<div class="outline-text-2" id="text-3">
<p>
「 org-mode reveal js 」とかでググってたら、こんなの (<a href="https://github.com/yjwen/org-reveal">`yjwen/org-reveal · GitHub</a>) があった。
</p>

<p>
案の定、 melpa にもあったので、 emacs からインストールしてみたけど、 melpa から依存関係上インストールした org-mode が emacs 24.2 では動かないので、 portage と git でインストールする。
</p>
<pre class="example">
# emerge =org-mode-8.0.2 --autounmask-write
$ cd ~/.emacs.d/path/to/
$ git clone git clone https://github.com/yjwen/org-reveal.git org-reveal
## パスは追加しておく
</pre>

<p>
<code>~/.emacs.el</code> に以下を書く。
</p>

<pre class="example">
(require 'ox-reveal)
</pre>

<p>
org-reveal を <code>git clone</code> したときの <code>~/.emacs.d/path/to/readme.org</code> を開いて、以下の行を適当な箇所に追加する。
</p>
<pre class="example">
#+REVEAL_ROOT: /home/kdkk-/dev/repo/revealjs/
</pre>

<p>
<code>C-c C-e R R</code> をタイプすると、同じフォルダに readme.org という名前のファイルが出力される。 webkit 対応のブラウザで開くとヌルヌル動く!!
書き方は <code>readme.org</code> 読みながら勉強中。。
</p>
</div>
</div>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://bartaz.github.io/impress.js/#/boredimpress.js">http://bartaz.github.io/impress.js/#/boredimpress.js</a> | presentation tool based on the power of CSS3 transforms and transitions in modern browsers | by Bartek Szopka @bartaz
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="http://blog.nishimiyahara.net/2013/02/revealjs-markdown.html">http://blog.nishimiyahara.net/2013/02/revealjs-markdown.html</a> あの reveal.js でのプレゼンを Markdown で簡単に書けるようにした - 新大阪でコワーキングスペースを主宰している Perl プログラマのブログ
</p></div>


</div>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[サスペンドできないときは cpu_hotplug 周りに気をつけよう]]></title>
    <link href="http://kixonn.github.io/blog/2013/05/24/cpu-hotplug-at-suspend/"/>
    <updated>2013-05-24T23:43:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/05/24/cpu-hotplug-at-suspend</id>
    <content type="html"><![CDATA[<p>
カーネルを <code>3.7.10</code> -&gt; <code>3.8.13</code> にアップデートしたら、サスペンドできなくなっていたので 2 日間ぐらい積んでいた。
サスペンドができないとラップトップを気軽に持ち運ぶこともできない (電源オフはキツい) 。
</p>




<p>
ひたすら ACPI 関連のオプションを触ってひたすら試行錯誤してみたけど、解決できなかった。
</p>




<div class="example:">

</div>




<p>
とか打っても大したログは見られない。。
</p>




<p>
結局、いろいろググって、 <code>CONFIG_HOTPLUG_CPU</code> が怪しいということがわかり、 <code>make oldconfig</code> したときに、 <code>BOOTPARAM_HOTPLUG_CPU0</code> について聞かれたの思い出したのでこれについて無効化して試してみたら、あっさりサスペンドできた。
</p>




<p>
カーネルの更新時にはよく確認しよう。
</p>




<p>
個人的には <code>make oldconfig</code> 使いたくなくて、普通に <code>make menuconfig</code> からいじりたいのだけどなぁ。
</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[stardict 用の英辞郎辞書ファイルを修復する]]></title>
    <link href="http://kixonn.github.io/blog/2013/05/22/fix-eijiro-in-stardict/"/>
    <updated>2013-05-22T08:20:00+09:00</updated>
    <id>http://kixonn.github.io/blog/2013/05/22/fix-eijiro-in-stardict</id>
    <content type="html"><![CDATA[<p>
以前， stardict 向けに変換した英辞郎の辞書ファイル <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> が起動時に stardict で読み込まれないので、原因を調べてみた。
</p>




<p>
stardict は <code>~/.stardict/stardict.cfg</code> にデフォルトの扱う辞書やデフォルトの辞書セットについての設定を保存しているようで、起動時にこれを読み込み、設定に変更が加えられるとファイルにも変更が反映されるようになっている。設定ファイルへの変更について調べていると、起動時の設定ファイルの読み込みの段階で問題があるために辞書ファイルが読みが失敗するよう。ちゃんとしたログメッセージを見たかったので、以下のようにオプションを付けて stardict を実行してみた。
</p>




<div class="html:">
<p>
Include file &#8217;<sub>code</sub> lang:bash 20130522/stardict&#8217; contains invalid characters or sequences
</p>

</div>




<p>
ログによると、辞書ファイルが壊れているらしい。 <code>stardict_stardict-verify</code> というコマンドがあったので実行してみると、 stardict の辞書ファイルで扱えるキーの長さが 256 文字までらしく、それを越える範囲でキーが設定されているため、辞書ファイルの読み込みに失敗するとのログが出力される。
</p>




<div class="html:">
<p>
Include file &#8217;<sub>code</sub> lang:bash 20130522/stardict<sub>stardict</sub>-verify&#8217; contains invalid characters or sequences
</p>

</div>




<p>
<code>stardict_stardict-repair</code> というコマンドも見つけたので、辞書ファイルが修復できるのではないかと思い、実行してみるけれども延々とした標準出力が得られるだけで結局、失敗した。
</p>




<p>
なんか、辞書ファイルの生成からやり直した方がよいと思うので、そのうちスクリプトを書くつもり。
</p>




<p>
現在は起動してから辞書ファイルを追加すれば、一応使用できるため面倒な作業に耐えられれば、常用できる。あと、普段は sdcv コマンドを使用しているので問題なかったりする。
</p>


<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://kdkk-.github.io/kdkk-/blog/2013/05/11/eijiro-on-stardict/%20little%20something%20about%20me./">http://kdkk-.github.io/kdkk-/blog/2013/05/11/eijiro-on-stardict/%20little%20something%20about%20me./</a> Linux の Stardict で英辞郎を使う - 日々、しこうさくごの足あと
</p></div>


</div>
</div>

]]></content>
  </entry>
  
</feed>
